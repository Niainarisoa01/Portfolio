[phases.setup]
nixPkgs = ['nodejs', 'python39', 'python39Packages.pip']

[phases.install]
cmds = [
  'python -m pip install --upgrade pip setuptools wheel',
  'pip install -r requirements.txt',
  'npm install --production=false'
]

[phases.build]
cmds = [
  'npm run build'
]

[start]
cmd = 'gunicorn wsgi:app --bind=0.0.0.0:$PORT --log-file -'

[deploy]
startCommand = 'gunicorn wsgi:app --bind=0.0.0.0:$PORT --log-file -'
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 3 